**Lab #1: Username enumeration via different responses**

This lab is vulnerable to username enumeration and password brute-force attacks. It has an account with a predictable username and password, which can be found in the following wordlists:

Candidate usernames
Candidate passwords
To solve the lab, enumerate a valid username, brute-force this user's password, then access their account page.

With Burp running, investigate the login page and submit an invalid username and password.
In Burp, go to Proxy > HTTP history and find the POST /login request. Highlight the value of the username parameter in the request and send it to Burp Intruder.
In Burp Intruder, go to the Positions tab. Notice that the username parameter is automatically set as a payload position. This position is indicated by two § symbols, for example: username=§invalid-username§. Leave the password as any static value for now.
Make sure that the Sniper attack type is selected.
On the Payloads tab, make sure that the Simple list payload type is selected.
Under Payload settings, paste the list of candidate usernames. Finally, click Start attack. The attack will start in a new window.
When the attack is finished, on the Results tab, examine the Length column. You can click on the column header to sort the results. Notice that one of the entries is longer than the others. Compare the response to this payload with the other responses. Notice that other responses contain the message Invalid username, but this response says Incorrect password. Make a note of the username in the Payload column.
Close the attack and go back to the Positions tab. Click Clear, then change the username parameter to the username you just identified. Add a payload position to the password parameter. The result should look something like this:

username=identified-user&password=§invalid-password§
On the Payloads tab, clear the list of usernames and replace it with the list of candidate passwords. Click Start attack.
When the attack is finished, look at the Status column. Notice that each request received a response with a 200 status code except for one, which got a 302 response. This suggests that the login attempt was successful - make a note of the password in the Payload column.
Log in using the username and password that you identified and access the user account page to solve the lab.

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/39233bd7-432e-496d-b74b-d2c32c0896c7)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/3d3c5e0b-f50c-4630-bec7-54d103a47688)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/dda57df4-5a15-40a5-b313-0948d082a737)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/1daa6826-f930-4188-a1ef-a6fc026dbfb1)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/f9631d79-9929-40db-9633-b924ffe5168e)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/52be3031-4e6e-4067-8a2b-e31d95ee4d07)

So username for this web application is ai .

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/5ce22911-f636-438e-907d-b323102d660c)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/41aac7eb-aeec-4599-9f9b-c1748d3be5fd)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/92b8ca81-5675-4f10-a336-556e80ef8981)

So password is michelle.

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/d9eb7ea0-6705-480f-9124-35de117e446e)

**Lab #2: 2FA simple bypass**

This lab's two-factor authentication can be bypassed. You have already obtained a valid username and password, but do not have access to the user's 2FA verification code. To solve the lab, access Carlos's account page.

Your credentials: wiener:peter
Victim's credentials carlos:montoya

Log in to your own account. Your 2FA verification code will be sent to you by email. Click the Email client button to access your emails.
Go to your account page and make a note of the URL.
Log out of your account.
Log in using the victim's credentials.
When prompted for the verification code, manually change the URL to navigate to /my-account. The lab is solved when the page loads.

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/4ade31f2-db39-4cda-9bc5-15f44a400c03)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/73359235-2c83-4ba6-9755-c37b5df51924)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/4e474c2b-435f-486e-baa7-ca3e924f664d)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/2f5d99f0-2019-4249-9b46-accd1b8bcfc5)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/91c67210-e33d-45ea-af74-82cc966a05b8)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/1a6e617b-6ba2-419c-940c-3c0b48674cdd)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/94092704-cf6d-4f20-9edb-f6e7222ff214)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/d3fa1516-6b99-4b57-9b0d-c96d278a401e)

**Lab #3: Password reset broken logic**

This lab's password reset functionality is vulnerable. To solve the lab, reset Carlos's password then log in and access his "My account" page.

Your credentials: wiener:peter
Victim's username: carlos

With Burp running, click the Forgot your password? link and enter your own username.
Click the Email client button to view the password reset email that was sent. Click the link in the email and reset your password to whatever you want.
In Burp, go to Proxy > HTTP history and study the requests and responses for the password reset functionality. Observe that the reset token is provided as a URL query parameter in the reset email. Notice that when you submit your new password, the POST /forgot-password?temp-forgot-password-token request contains the username as hidden input. Send this request to Burp Repeater.
In Burp Repeater, observe that the password reset functionality still works even if you delete the value of the temp-forgot-password-token parameter in both the URL and request body. This confirms that the token is not being checked when you submit the new password.
In the browser, request a new password reset and change your password again. Send the POST /forgot-password?temp-forgot-password-token request to Burp Repeater again.
In Burp Repeater, delete the value of the temp-forgot-password-token parameter in both the URL and request body. Change the username parameter to carlos. Set the new password to whatever you want and send the request.
In the browser, log in to Carlos's account using the new password you just set. Click My account to solve the lab.

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/4d6e7ada-fa28-441e-82fe-d288feb89f4c)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/c2179db6-fb1b-43b4-a507-96bb4503d6a7)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/2b4e22f3-1e58-45c7-9e48-2014a8e67824)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/d8f876ef-cd8e-4e78-b7ec-b88fb30b1596)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/a174a980-fa6f-4d87-8671-a2adf0fe7ac5)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/398ab414-cc74-43e3-a9e7-13cd486417ec)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/22a4041d-16aa-44f0-a3ba-68408b60837f)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/a8de95e8-cdc9-458d-af4f-eab75379549c)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/846c5109-5758-4f53-b387-3c27266fc03d)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/3f10a6c7-961a-441f-9c74-4d8a253f59b9)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/f36c3f52-9ca6-4684-bdea-d367c80241f9)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/328e2843-74a0-4004-baab-a71aa32d02bb)

**Lab #4: Username enumeration via subtly different responses**

This lab is subtly vulnerable to username enumeration and password brute-force attacks. It has an account with a predictable username and password, which can be found in the following wordlists:

Candidate usernames
Candidate passwords
To solve the lab, enumerate a valid username, brute-force this user's password, then access their account page.

With Burp running, submit an invalid username and password. Highlight the username parameter in the POST /login request and send it to Burp Intruder.
On the Payloads tab, notice that the username parameter is automatically marked as a payload position. Make sure that the Simple list payload type is selected and add the list of candidate usernames.
On the Settings tab, under Grep - Extract, click Add. In the dialog that appears, scroll down through the response until you find the error message Invalid username or password.. Use the mouse to highlight the text content of the message. The other settings will be automatically adjusted. Click OK and then start the attack.
When the attack is finished, notice that there is an additional column containing the error message you extracted. Sort the results using this column to notice that one of them is subtly different.
Look closer at this response and notice that it contains a typo in the error message - instead of a full stop/period, there is a trailing space. Make a note of this username.
Close the attack and go back to the Positions tab. Insert the username you just identified and add a payload position to the password parameter:

username=identified-user&password=§invalid-password§
On the Payloads tab, clear the list of usernames and replace it with the list of passwords. Start the attack.
When the attack is finished, notice that one of the requests received a 302 response. Make a note of this password.
Log in using the username and password that you identified and access the user account page to solve the lab.

![WhatsApp Image 2023-06-03 at 19 39 24](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/c4c1629c-0c12-48d1-9a9b-80237826f8b3)

![WhatsApp Image 2023-06-03 at 19 39 40](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/502a22a9-1314-4f26-92ed-2c8c79f2d354)

![WhatsApp Image 2023-06-03 at 19 40 22](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/9d0d24da-aa31-4f29-a627-e49e086e44c4)

![WhatsApp Image 2023-06-03 at 19 41 01](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/5ad865ed-6779-4335-95e1-00f440a49b27)

![WhatsApp Image 2023-06-03 at 19 43 02](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/cf2f1a5c-0f73-4663-aa3d-6b7b2ed8df24)

![WhatsApp Image 2023-06-03 at 19 43 57](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/759875f0-2841-460d-87a4-3d0fcdbb84b6)

![WhatsApp Image 2023-06-03 at 19 50 08](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/0a1c8067-01b8-4a66-a495-01450c00de07)

![WhatsApp Image 2023-06-03 at 19 51 38](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/7ff0b9ed-aca3-4a8b-b699-58a36fe23a95)

![WhatsApp Image 2023-06-03 at 19 52 25](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/4dc4927e-a1d5-4f8a-8332-1a8b69e3600e)

![WhatsApp Image 2023-06-03 at 19 53 32](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/722938d9-adc8-4e1f-b40e-d3fda7fc8f7f)

**Lab #5: Username enumeration via response timing**

This lab is vulnerable to username enumeration using its response times. To solve the lab, enumerate a valid username, brute-force this user's password, then access their account page.

Your credentials: wiener:peter
Candidate usernames
Candidate passwords

With Burp running, submit an invalid username and password, then send the POST /login request to Burp Repeater. Experiment with different usernames and passwords. Notice that your IP will be blocked if you make too many invalid login attempts.
Identify that the X-Forwarded-For header is supported, which allows you to spoof your IP address and bypass the IP-based brute-force protection.
Continue experimenting with usernames and passwords. Pay particular attention to the response times. Notice that when the username is invalid, the response time is roughly the same. However, when you enter a valid username (your own), the response time is increased depending on the length of the password you entered.
Send this request to Burp Intruder and select the attack type to Pitchfork. Add the X-Forwarded-For header.
Add payload positions for the X-Forwarded-For header and the username parameter. Set the password to a very long string of characters (about 100 characters should do it).
On the Payloads tab, select payload set 1. Select the Numbers payload type. Enter the range 1 - 100 and set the step to 1. Set the max fraction digits to 0. This will be used to spoof your IP.
Select payload set 2 and add the list of usernames. Start the attack.
When the attack finishes, at the top of the dialog, click Columns and select the Response received and Response completed options. These two columns are now displayed in the results table.
Notice that one of the response times was significantly longer than the others. Repeat this request a few times to make sure it consistently takes longer, then make a note of this username.
Create a new Burp Intruder attack for the same request. Add the X-Forwarded-For header again and add a payload position to it. Insert the username that you just identified and add a payload position to the password parameter.
On the Payloads tab, add the list of numbers in payload set 1 and add the list of passwords to payload set 2. Start the attack.
When the attack is finished, find the response with a 302 status. Make a note of this password.
Log in using the username and password that you identified and access the user account page to solve the lab.

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/c43a6b43-f629-44cf-8e8c-0004cf79f56f)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/6e64e155-7279-4957-8e64-3e4bc40222d9)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/1c54da43-9e42-472f-81d4-09cfefb74e7e)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/d04982c8-c2fb-4951-9786-fd9bd3450ae7)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/15034244-7db9-47dc-9477-2b5cd1222263)

![image](https://github.com/SURYASNAIR1/PortSwigger/assets/123303806/7c2f5a1f-7004-44e2-a75e-abc3b7f3314b)

**Lab #6: Username enumeration via response timing**

This lab is vulnerable to username enumeration using its response times. To solve the lab, enumerate a valid username, brute-force this user's password, then access their account page.

Your credentials: wiener:peter

With Burp running, submit an invalid username and password, then send the POST /login request to Burp Repeater. Experiment with different usernames and passwords. Notice that your IP will be blocked if you make too many invalid login attempts.
Identify that the X-Forwarded-For header is supported, which allows you to spoof your IP address and bypass the IP-based brute-force protection.
Continue experimenting with usernames and passwords. Pay particular attention to the response times. Notice that when the username is invalid, the response time is roughly the same. However, when you enter a valid username (your own), the response time is increased depending on the length of the password you entered.
Send this request to Burp Intruder and select the attack type to Pitchfork. Add the X-Forwarded-For header.
Add payload positions for the X-Forwarded-For header and the username parameter. Set the password to a very long string of characters (about 100 characters should do it).
On the Payloads tab, select payload set 1. Select the Numbers payload type. Enter the range 1 - 100 and set the step to 1. Set the max fraction digits to 0. This will be used to spoof your IP.
Select payload set 2 and add the list of usernames. Start the attack.
When the attack finishes, at the top of the dialog, click Columns and select the Response received and Response completed options. These two columns are now displayed in the results table.
Notice that one of the response times was significantly longer than the others. Repeat this request a few times to make sure it consistently takes longer, then make a note of this username.
Create a new Burp Intruder attack for the same request. Add the X-Forwarded-For header again and add a payload position to it. Insert the username that you just identified and add a payload position to the password parameter.
On the Payloads tab, add the list of numbers in payload set 1 and add the list of passwords to payload set 2. Start the attack.
When the attack is finished, find the response with a 302 status. Make a note of this password.
Log in using the username and password that you identified and access the user account page to solve the lab.

